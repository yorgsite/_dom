const _dom=function(){if(window._dom)return window._dom;let e="__dom";const t={};class n{constructor(e,t,n){let o;this.tagName=e,this.constructor=t,this.cssRules="function"==typeof n?n:"object"==typeof n?function(){return n}:0,this.getRules=function(e){return this.cssRules&&!o&&(o=r.rules(this.cssRules())),o}}build(t){var n=this.instance(t);return Object.defineProperty(n.dom,e,{get:function(){return n},configurable:!0}),n.dom}instance(e){return new o(this,e)}}class o{constructor(e,t){if(Object.defineProperty(this,"tagName",{get:function(){return e.tagName}}),e.cssRules){var n=e.getRules();Object.defineProperty(this,"rules",{get:function(){return n}})}var o=e.constructor.apply(this,t);if(!(o instanceof HTMLElement))throw console.error("-----------------------"),console.log("tagName=",e.tagName),console.log("constructor=",e.constructor),console.log("this.dom=",o),"\n_dom.model Error:\nconstructor must return an HTMLElement.";o.__dom&&(this._super=o.__dom),"dom"in this||Object.defineProperty(this,"dom",{get:function(){return o}})}}const r=function(e,n,o,s){let l,i=arguments;if(e in t)return t[e].build(i);try{l="string"==typeof s?document.createElementNS(s,e):document.createElement(e),!o&&n instanceof Array&&(o=n,n={});let t=function(e,n,o){if(void 0===e)throw"property '"+o+"' doesn't exist.";for(let r in n)"object"==typeof n[r]?t(e[r],n[r],o+"."+r):e[r]=n[r]};t(l,n,(""+e).toUpperCase()),r.append(l,o)}catch(e){throw console.error("----------_dom Error"),console.log("arguments=",i),console.log("error=",e),"_dom Error:\n"+e}return l};r.append=function(e,t){if(!(e instanceof HTMLElement))throw"_dom.append Error:\nparameter dom must be a dom element.";if(t&&"number"==typeof t.length)if("string"==typeof t)e.innerHTML+=t;else for(let n=0;n<t.length;n++)if("string"==typeof t[n])e.appendChild(document.createTextNode(t[n]));else try{e.appendChild(t[n])}catch(e){throw console.error("-----------------------"),console.log("childs["+n+"]=",t[n]),console.log("error=",e),"_dom.append Error:\nparameter childs["+n+"] must be string or dom element."}},r.model=function(e,o,s,l){if(-1===e.indexOf("-")&&console.warn('_dom.model suspect tagName "'+e+'" should contain at least one "-" to avoid conflict with natives HTMLElements.'),e in t)throw'\n_dom.model Error:\ntagName "'+e+'" allready exists.';if("function"!=typeof o)throw console.error("----------_dom.model Error"),console.log("tagName=",e),console.log("constructor=",o),"\n_dom.model Error:\nconstructor must be a function.";t[e]=new n(e,o,s),l&&r.modelShadow(e,l)},r.has=function(e){return e in t},r.instance=function(e,n){if(!(e in t))throw console.error("----------_dom.instance Error"),console.log("arguments=",arguments),'\n_dom.instance Error:\ntagName "'+e+'" not found in models.';return t[e].instance(arguments)},r.findParent=function(e,t,n=10){let o=[];if(e instanceof HTMLElement||o.push('arg[0] "dom" is not an HTMLElement.'),"function"!=typeof t&&o.push('arg[1] "condition" is not a function.'),("number"!=typeof n||n<2)&&o.push('arg[2] "maxDeep" is not a number with a value > 1 ."'),o.length)throw console.error("----------_dom.findParent Error"),console.log("arguments=",arguments),"\n_dom.findParent Error:\n"+o.map(e=>"\t- "+e).join("\n");for(let o=0;o<n&&e.parentNode;o++){if(t(e))return e;e=e.parentNode}},r.events=function(e,t){(t instanceof Array?t:[t]).forEach(t=>{(t.type instanceof Array?t.type:[t.type]).forEach(n=>e.addEventListener(t.type,t.callback))})},Object.defineProperty(r,"models",{get:function(){return Object.keys(t)}});let s={};r.defaultCss=function(e){let t,n;if(e instanceof HTMLElement&&(t=e),t||!s.hasOwnProperty(e)){let o,r=document.documentElement;try{o=document.createElement(e),r.appendChild(o);let l=window.getComputedStyle(o);n=new Map,Object.keys(l).map(e=>l[e]).filter(e=>"-"!==e.charAt(0)&&""!==l[e]).forEach(e=>n.set(e,l[e])),t||(s[e]=n),r.removeChild(o)}catch(e){throw o&&o.parentNode&&r.removeChild(o),"\n_dom.properties Error:\n"+e}}else n=s[e];return n},Object.defineProperty(r,"uid",{get:()=>Date.now().toString(16)+"-"+Math.floor(1e12*Math.random()).toString(16)}),Object.defineProperty(r,"sheet",{get:function(){return 0==document.styleSheets.length&&document.documentElement.appendChild(r("style",[""])),document.styleSheets[document.styleSheets.length-1]}});const l=function(e,t,n,o,s){if("string"!=typeof e||!e.length)throw console.error("----------_dom.rule Error"),console.log("selector=",e),"\n_dom.rule Error:\nselector is not a valid css query.";n instanceof CSSStyleSheet||(n=r.sheet),n.insertRule(e+"{\n\n}",n.cssRules.length);let l=n.cssRules[n.cssRules.length-1];if(t){let e=(t,n)=>{for(let r in t)"object"==typeof t[r]?(l.appendRule(r+"{\n\n}"),e(t[r],l.cssRules[l.cssRules.length-1])):n.style[r]=t[r],o&&r in s&&(o[s[r]]=o[r])};e(t,l)}return l};r.rule=function(e,t,n){return l(e,t,n)},r.rules=function(e,t,n=""){let o="";n&&(o=n+"-"+r.uid,e={["."+o]:e});let s={},i=r.getRulesData(e);t instanceof CSSStyleSheet||(t=r.sheet);for(let e in i.rules){try{s[e]=l(e,i.rules[e],t,s,i.alias)}catch(t){console.warn('_dom.rules Warning:\nInsertion of rule "'+e+'" failed!\n\n'+t)}e in i.alias&&(s[i.alias[e]]=s[e])}return o?{className:o,rules:s}:s},r.getRulesData=function(e){let t={rules:{},alias:{}},n=function(e,o,r,s){let l,i={};r.length&&(l=r.join(""));for(let c in e){let a=c.charAt(0);if("$"===a)o[c.substr(1)]=e[c];else if("@"===a){let t={rules:{}};n(e[c],Object.assign({},o),[],t),s.rules[c]=t.rules}else if(r.length&&"&"!==a)if("alias"===c)t.alias[l]=e[c];else{let t=e[c]+"";Object.keys(o).forEach(e=>{t=t.indexOf(e)>-1?t.split(e).join(o[e]):t}),i[c]=t}else(r.length?c.substr(1):c).split(",").forEach(t=>{n(e[c],Object.assign({},o),r.concat([t]))})}l&&(s.rules[l]?Object.assign(t.rules[l],i):s.rules[l]=i)};return n(e,{},[]),t},r.modelRules=function(e,n=0){let o={};if(("Array"===e.constructor.name?e:[e]).forEach(e=>{if(t[e]){let n=t[e].getRules();for(let e in n)o[e]=n[e]}}),n)for(let e in o)n.insertRule(o[e].cssText);return o};return r.modelShadowed=function(e){return!!t[e].shadow},r.modelShadow=function(e,n){if(!t[e])throw["","_dom.modelShadow Error:",'argument[0] "tagName"="'+e+'" has no model declared.'].join("\n");{if(r.modelShadowed(e))return;n="object"==typeof n?n:{};let o=e.split("-").map(e=>e.charAt(0).toUpperCase()+e.substr(1)).join(""),s=(t[e].constructor+"").split(")",2)[0].split("(")[1].split(","),l=s.map(e=>n.hasOwnProperty(e)?n[e]:0);class i extends HTMLElement{constructor(){super(),function(e,t,n,o){let s,l=e.attachShadow({mode:"open"});o=o||[];let i=n.slice(1).map((t,n)=>{let r,s=n+1;if(e.hasAttribute(t))if(r=e.getAttribute(t),"function"==typeof o[s])r=o[s](r);else if("boolean"===o[s])r=!(["false","0","off"].indexOf(r)>-1||!r.length);else if("int"===o[s])r=parseInt(r);else if("number"===o[s])r=parseFloat(r);else if("function"===o[s])r=new Function(""+r).bind(e);else if("string"!==o[s])try{r=JSON.parse(r)}catch(e){}return r});n=[t].concat(i),s=r.apply(null,n),l.appendChild(s);let c=[],a=s.__dom.rules;for(let e in a)c.push(a[e].cssText);l.appendChild(r("style",{type:"text/css",textContent:c.join("\n")}))}(this,e,s,l)}}t[e].shadow={name:o,[o]:class extends i{}},customElements.define(e,t[e].shadow[o])}},r}();